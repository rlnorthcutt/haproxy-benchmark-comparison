global
    log stdout format raw daemon
    maxconn 100000
    stats socket /var/run/haproxy.sock mode 600 level admin expose-fd listeners
    stats timeout 30s

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5s
    timeout client  30s
    timeout server  30s

frontend http_front
    bind *:80
    default_backend app_backend

frontend prometheus
    bind *:8404
    http-request use-service prometheus-exporter if { path /metrics }

backend app_backend
    balance roundrobin
    server app1 benchmark-ntex-app-1:8080 check
    server app2 benchmark-ntex-app-2:8080 check
